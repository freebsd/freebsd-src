#! /bin/sh -

#
# $FreeBSD: src/release/picobsd/build/clean,v 1.12.2.2 2000/07/01 13:54:34 roger Exp $
#
set -e

TARGETS="dial net isp router bridge"
if [ $# -lt 1 ]; then
    echo "What to clean? Possible targets are ${TARGETS} or 'all'"
    exit 1
fi

if [ "$1" = "all" ]; then
    list=${TARGETS}
    old="old"
else
    list=$1
    old=$1
fi
if [ -f picobsd.bin ]; then
    mv -f picobsd.bin picobsd.bin.${old}
fi

rm -f kernel kernel.gz fs.PICOBSD *.o *core *.db \
	.build.reply stage1.out build.status .image.list
cd ..
rm -rf help/tmp_hlp
echo "===================== $0 tools started ===================="
for i in `ls -d tinyware/[a-z]*` ; do
	(cd ${i}; \
	if [ -f Makefile ]; then \
		make clean && make cleandepend;\
	fi)
done
for j in $list ; do
	echo "===================== $0 $j started ======================"
	(cd ${j}/crunch1; \
	make -f ../../build/Makefile.crunch clean ; \
	)
	echo "=============== $0 $j completed successfuly =============="
done
