#! /bin/sh -

#
#	$Id: clean,v 1.10 1999/08/23 08:33:07 luigi Exp $
#
set -e

TARGETS="dial net isp router"
if [ $# -lt 1 ]; then
    echo "What to clean? Possible targets are ${TARGETS} or 'all'"
    exit 1
fi

if [ "$1" = "all" ]; then
    list=${TARGETS}
    old="old"
else
    list=$1
    old=$1
fi
if [ -f picobsd.bin ]; then
    mv -f picobsd.bin picobsd.bin.${old}
fi

rm -f kernel kernel.gz fs.PICOBSD *.o *core *.db \
	.build.reply stage1.out build.status
cd ..
rm -rf help/tmp_hlp
echo "===================== $0 tools started ===================="
for i in `ls -d tinyware/[a-z]*` tools/write_mfs_in_kernel ; do
	(cd ${i}; \
	if [ -f Makefile ]; then \
	     make clean && make cleandepend;\
	fi)
done
for j in $list ; do
	echo "===================== $0 $j started ======================"
	(cd ${j}/crunch1; \
	if [ -f Makefile ]; then \
	     make clean ; \
	fi)
	echo "=============== $0 $j completed successfuly =============="
done
