#!/usr/bin/python

from k5test import *

realm = K5Realm(realm='TEST')

# CVE-2013-1417 KDC dereferences null pointer

realm.kinit(realm.user_princ, password('user'))
realm.run([kvno, '-S', 'host', 'example.com'], expected_code=1)
# Make sure KDC is still running.
realm.kinit(realm.user_princ, password('user'))
success('CVE-2013-1417 regression test')
